# 新しい動画タイプ追加のための手順書

将来的に 1問1答以外の動画タイプ（例: 解説動画、スライド動画、ショート講義など）を追加するときの基本方針と、共通コードを活用しながら拡張するための手順をまとめます。

## 1. 設計指針

- **共通化できる設定・ロジックは `src/common/` へ集約**  
  レイアウト、テーマ、キャラクター表示などは他の動画タイプでも再利用できるよう汎用的に保つ。
- **表示コンポーネントは `src/components/`**  
  汎用 UI（テキストカード、背景、キャラクター表示など）は既存のものを活用し、足りない場合はここに追加する。
- **動画タイプごとの組み立ては `src/compositions/`**  
  新規動画タイプは新しい Composition コンポーネントを作成し、必要なシーケンスの切り替えロジックを記述する。
- **データ定義は `src/data/` 以下に種類別に整理**  
  1問1答は `scripts/`。別タイプを追加する際は、`src/data/<video-type>/` のように分離する。

## 2. 新しいコンポジションを追加する流れ

1. **データモデルの見直し**  
   既存の `src/types.ts` を確認し、新しい動画タイプに必要なフィールドを追加または拡張する。汎用化できるものは既存型にマージし、動画タイプ固有のものは拡張型として別途定義する。
2. **共通ロジックの再利用**  
   - タイムライン生成が流用できる場合は `common/storyboard.ts` にジェネリックな仕組みを追加。
   - 特定動画タイプにのみ必要なロジックは `common` 内にサブモジュールを作成して整理する。
3. **Composition コンポーネントの作成**  
   - `src/compositions/<NewVideoType>Composition.tsx` を作成。
   - 共通コンポーネント (`BackgroundCanvas`, `CharacterOverlay` など) を活用しながら、新しい演出に必要なコンポーネントを追加する。
4. **RemotionRoot への登録**  
   - `src/RemotionRoot.tsx` に新しい動画タイプのデータ配列を読み込み、`<Composition>` を追加する。
   - `id` がユニークになるよう命名し、`defaultProps` や `fps` が適切か確認する。
5. **レンダリングスクリプトの更新**  
   - `scripts/render-all.ts` に新しい集合を読み込ませる、または動画タイプごとに処理を振り分ける。
   - 必要に応じて CLI 引数で対象動画タイプを選べるよう拡張する。

## 3. コンポーネント再利用のヒント

- `QAContentCard` は見出し・本文・カウンタを持つ汎用的なカード。文言・配色を変えれば他タイプでも再利用できる。
- アニメーションを変えたい場合は、`useCurrentFrame` と `interpolate` を利用しつつ、補助関数を `components/animations/` といったディレクトリにまとめると拡張しやすい。
- 複数動画タイプで使う音声・画像などは `public/` 配下に種類別 (`/audio`, `/characters`, `/images` など) に整理する。

## 4. データ定義を増やす際のルール

- `id` は Remotion の Composition ID としても利用するため、半角英数字とハイフンのみを推奨。
- 長さ・タイミングのデフォルト値は `common/constants.ts` を基準とし、個別に調整したい場合はデータ側でオーバーライドする。
- JSON で管理する場合は `resolveJsonModule` が有効になっているため、TypeScript から直接読み込んで型チェック可能。

## 5. テスト・検証のすすめ

- 新タイプを追加したら Remotion Studio (`npm run dev`) で全セグメントを確認する。
- 音声付きの場合は実際にレンダリング (`npm run render:all`) して同期ズレがないか確認。
- UI コンポーネントは Storybook を導入するか、簡易的なテスト用 Composition を作成して視覚的に確認する方法が有効。

この手順に従うことで、1問1答以外のタイプにも共通資産を最大限活かしながら効率的に拡張できます。
